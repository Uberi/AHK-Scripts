#SingleInstance, force
file = %1%

def := []
;Thanks to:
;http://www.filesignatures.net
def.insert({e:"*", s:"D4C3B2A1", d:"WinDump (winpcap) capture file"})
def.insert({e:"*", s:"EFBBBF", d:"UTF8 file"})
def.insert({e:"*", s:"7F454C46", d:"ELF executable"})
def.insert({e:"*", s:"62706C697374", d:"Binary property list (plist)"})
def.insert({e:"*", s:"41435344", d:"AOL parameter|info files"})
def.insert({e:"*", s:"3037303730", d:"cpio archive"})
def.insert({e:"*", s:"ACED", d:"Java serialization data"})
def.insert({e:"*", s:"05000000", d:"INFO2 Windows recycle bin_2"})
def.insert({e:"*", s:"04000000", d:"INFO2 Windows recycle bin_1"})
def.insert({e:"*", s:"4B57414A88F027D1", d:"KWAJ (compressed) file"})
def.insert({e:"*", s:"535A2088F02733D1", d:"QBASIC SZDD file"})
def.insert({e:"*", s:"37E45396C9DBD607", d:"zisofs compressed file"})
def.insert({e:"*", s:"A1B2CD34", d:"Extended tcpdump (libpcap) capture file"})
def.insert({e:"*", s:"34CDB2A1", d:"Tcpdump capture file"})
def.insert({e:"*", s:"A1B2C3D4", d:"tcpdump (libpcap) capture file"})
def.insert({e:"*", s:"626567696E", d:"UUencoded file"})
def.insert({e:"*", s:"6F3C", d:"SMS text (SIM)"})
def.insert({e:"*", s:"FFFE0000", d:"UTF-32|UCS-4 file"})
def.insert({e:"*", s:"CD20AAAA02000000", d:"NAV quarantined virus file"})
def.insert({e:"*", s:"535A444488F02733", d:"SZDD file format"})
def.insert({e:"*", s:"001400000102", d:"BIOS details in RAM"})
def.insert({e:"*", s:"FEFF", d:"UTF-16|UCS-2 file"})
def.insert({e:"123", s:"00001A00051004", d:"Lotus 1-2-3 (v9)"})
def.insert({e:"386", s:"4D5A", d:"Windows virtual device drivers"})
def.insert({e:"3GP", s:"0000002066747970", d:"3GPP2 multimedia files"})
def.insert({e:"3GP", s:"0000001466747970", d:"3GPP multimedia files"})
def.insert({e:"3GP5", s:"0000001866747970", d:"MPEG-4 video files"})
def.insert({e:"4XM", s:"52494646", d:"4X Movie video"})
def.insert({e:"7Z", s:"377ABCAF271C", d:"7-Zip compressed file"})
def.insert({e:"ABA", s:"00014241", d:"Palm Address Book Archive"})
def.insert({e:"ABD", s:"5157205665722E20", d:"ABD | QSD Quicken data file"})
def.insert({e:"ABI", s:"414F4C", d:"AOL config files"})
def.insert({e:"ABI", s:"414F4C494E444558", d:"AOL address book index"})
def.insert({e:"ABY", s:"414F4C", d:"AOL config files"})
def.insert({e:"ABY", s:"414F4C4442", d:"AOL address book"})
def.insert({e:"AC", s:"72696666", d:"Sonic Foundry Acid Music File"})
def.insert({e:"ACCDB", s:"000100005374616E6461726420414345204442", d:"Microsoft Access 2007"})
def.insert({e:"ACM", s:"4D5A", d:"MS audio compression manager driver"})
def.insert({e:"ACS", s:"C3ABCDAB", d:"MS Agent Character file"})
def.insert({e:"AC_", s:"D0CF11E0A1B11AE1", d:"CaseWare Working Papers"})
def.insert({e:"AD", s:"5245564E554D3A2C", d:"Antenna data file"})
def.insert({e:"ADF", s:"444F53", d:"Amiga disk file"})
def.insert({e:"ADP", s:"D0CF11E0A1B11AE1", d:"Access project file"})
def.insert({e:"ADX", s:"0300000041505052", d:"Approach index file"})
def.insert({e:"ADX", s:"80000020031204", d:"Dreamcast audio"})
def.insert({e:"AIFF", s:"464F524D00", d:"Audio Interchange File"})
def.insert({e:"AIN", s:"2112", d:"AIN Compressed Archive"})
def.insert({e:"AMR", s:"2321414D52", d:"Adaptive Multi-Rate ACELP Codec (GSM)"})
def.insert({e:"ANI", s:"52494646", d:"Windows animated cursor"})
def.insert({e:"API", s:"4D5A900003000000", d:"Acrobat plug-in"})
def.insert({e:"APR", s:"D0CF11E0A1B11AE1", d:"Lotus|IBM Approach 97 file"})
def.insert({e:"ARC", s:"1A09", d:"LH archive (old vers.|type 5)"})
def.insert({e:"ARC", s:"1A08", d:"LH archive (old vers.|type 4)"})
def.insert({e:"ARC", s:"41724301", d:"FreeArc compressed file"})
def.insert({e:"ARC", s:"1A04", d:"LH archive (old vers.|type 3)"})
def.insert({e:"ARC", s:"1A03", d:"LH archive (old vers.|type 2)"})
def.insert({e:"ARC", s:"1A02", d:"LH archive (old vers.|type 1)"})
def.insert({e:"ARJ", s:"60EA", d:"ARJ Compressed archive file"})
def.insert({e:"ARL", s:"D42A", d:"AOL history|typed URL files"})
def.insert({e:"ASF", s:"3026B2758E66CF11", d:"Windows Media Audio|Video File"})
def.insert({e:"AST", s:"5343486C", d:"Underground Audio"})
def.insert({e:"ASX", s:"3C", d:"Advanced Stream Redirector"})
def.insert({e:"AU", s:"2E736E64", d:"NeXT|Sun Microsystems audio file"})
def.insert({e:"AU", s:"646E732E", d:"Audacity audio file"})
def.insert({e:"AUT", s:"D42A", d:"AOL history|typed URL files"})
def.insert({e:"AVI", s:"52494646", d:"Resource Interchange File Format"})
def.insert({e:"AW", s:"8A0109000000E108", d:"MS Answer Wizard"})
def.insert({e:"AX", s:"4D5A", d:"Library cache file"})
def.insert({e:"AX", s:"4D5A900003000000", d:"DirectShow filter"})
def.insert({e:"BAG", s:"414F4C", d:"AOL config files"})
def.insert({e:"BAG", s:"414F4C2046656564", d:"AOL and AIM buddy list"})
def.insert({e:"BDR", s:"5854", d:"MS Publisher"})
def.insert({e:"BIN", s:"424C4932323351", d:"Speedtouch router firmware"})
def.insert({e:"BMP", s:"424D", d:"Bitmap image"})
def.insert({e:"BZ2", s:"425A68", d:"bzip2 compressed archive"})
def.insert({e:"CAB", s:"49536328", d:"Install Shield compressed file"})
def.insert({e:"CAB", s:"4D534346", d:"Microsoft cabinet file"})
def.insert({e:"CAL", s:"B5A2B0B3B3B0A5B5", d:"Windows calendar"})
def.insert({e:"CAL", s:"737263646F636964", d:"CALS raster bitmap"})
def.insert({e:"CAL", s:"537570657243616C", d:"SuperCalc worksheet"})
def.insert({e:"CAP", s:"58435000", d:"Packet sniffer files"})
def.insert({e:"CAP", s:"52545353", d:"WinNT Netmon capture file"})
def.insert({e:"CAS", s:"5F434153455F", d:"EnCase case file"})
def.insert({e:"CAT", s:"30", d:"MS security catalog file"})
def.insert({e:"CBD", s:"434246494C45", d:"WordPerfect dictionary"})
def.insert({e:"CBK", s:"5F434153455F", d:"EnCase case file"})
def.insert({e:"CDA", s:"52494646", d:"Resource Interchange File Format"})
def.insert({e:"CDR", s:"454C49544520436F", d:"Elite Plus Commander game file"})
def.insert({e:"CDR", s:"52494646", d:"CorelDraw document"})
def.insert({e:"CDR", s:"4D535F564F494345", d:"Sony Compressed Voice File"})
def.insert({e:"CFG", s:"5B666C7473696D2E", d:"Flight Simulator Aircraft Configuration"})
def.insert({e:"CHI", s:"49545346", d:"MS Compiled HTML Help File"})
def.insert({e:"CHM", s:"49545346", d:"MS Compiled HTML Help File"})
def.insert({e:"CLASS", s:"CAFEBABE", d:"Java bytecode"})
def.insert({e:"CLB", s:"434D5831", d:"Corel Binary metafile"})
def.insert({e:"CLB", s:"434F4D2B", d:"COM+ Catalog"})
def.insert({e:"CMX", s:"52494646", d:"Corel Presentation Exchange metadata"})
def.insert({e:"CNV", s:"53514C4F434F4E56", d:"DB2 conversion file"})
def.insert({e:"COD", s:"4E616D653A20", d:"Agent newsreader character map"})
def.insert({e:"COM", s:"EB", d:"Windows executable file_3"})
def.insert({e:"COM", s:"E9", d:"Windows executable file_2"})
def.insert({e:"COM", s:"E8", d:"Windows executable file_1"})
def.insert({e:"COM", s:"4D5A", d:"Windows|DOS executable file"})
def.insert({e:"COM", f:"EXE32", d:"PE (Win32) executable file"})
def.insert({e:"CPE", s:"464158434F564552", d:"MS Fax Cover Sheet"})
def.insert({e:"CPI", s:"FF464F4E54", d:"Windows international code page"})
def.insert({e:"CPI", s:"53494554524F4E49", d:"Sietronics CPI XRD document"})
def.insert({e:"CPL", s:"DCDC", d:"Corel color palette"})
def.insert({e:"CPL", s:"4D5A", d:"Control panel application"})
def.insert({e:"CPT", s:"43505446494C45", d:"Corel Photopaint file_2"})
def.insert({e:"CPT", s:"4350543746494C45", d:"Corel Photopaint file_1"})
def.insert({e:"CPX", s:"5B57696E646F7773", d:"Microsoft Code Page Translation file"})
def.insert({e:"CRU", s:"43525553482076", d:"Crush compressed archive"})
def.insert({e:"CRW", s:"49491A0000004845", d:"Canon RAW file"})
def.insert({e:"CSH", s:"6375736800000002", d:"Photoshop Custom Shape"})
def.insert({e:"CTF", s:"436174616C6F6720", d:"WhereIsIt Catalog"})
def.insert({e:"CTL", s:"56455253494F4E20", d:"Visual Basic User-defined Control file"})
def.insert({e:"CUR", s:"00000200", d:"Windows cursor"})
def.insert({e:"DAT", s:"43524547", d:"Win9x registry hive"})
def.insert({e:"DAT", s:"4E41565452414646", d:"TomTom traffic data"})
def.insert({e:"DAT", s:"72656766", d:"WinNT registry file"})
def.insert({e:"DAT", s:"736C6821", d:"Allegro Generic Packfile (compressed)"})
def.insert({e:"DAT", s:"496E6E6F20536574", d:"Inno Setup Uninstall Log"})
def.insert({e:"DAT", s:"4552465353415645", d:"EasyRecovery Saved State file"})
def.insert({e:"DAT", s:"A90D000000000000", d:"Access Data FTK evidence"})
def.insert({e:"DAT", s:"415647365F496E74", d:"AVG6 Integrity database"})
def.insert({e:"DAT", s:"504E4349554E444F", d:"Norton Disk Doctor undo file"})
def.insert({e:"DAT", s:"03", d:"MapInfo Native Data Format"})
def.insert({e:"DAT", s:"55464F4F72626974", d:"UFO Capture map file"})
def.insert({e:"DAT", s:"52494646", d:"Video CD MPEG movie"})
def.insert({e:"DAT", s:"436C69656E742055", d:"IE History file"})
def.insert({e:"DAT", s:"50455354", d:"PestPatrol data|scan strings"})
def.insert({e:"DAT", s:"4E41565452414646", d:"TomTom traffic data"})
def.insert({e:"DAT", s:"43524547", d:"Win9x registry hive"})
def.insert({e:"DAT", s:"72656766", d:"WinNT registry file"})
def.insert({e:"DAT", s:"52415A4154444231", d:"Shareaza (P2P) thumbnail"})
def.insert({e:"DB", s:"53514C69746520666F726D6174203300", d:"SQLite database file"})
def.insert({e:"DB", s:"D0CF11E0A1B11AE1", d:"MSWorks database file"})
def.insert({e:"DB", s:"44424648", d:"Palm Zire photo database"})
def.insert({e:"DB", s:"FDFFFFFF", d:"Thumbs.db subheader"})
def.insert({e:"DB", s:"0006156100000002000004D200001000", d:"Netscape Navigator (v4) database"})
def.insert({e:"DB", s:"08", d:"dBASE IV or dBFast configuration file"})
def.insert({e:"DB3", s:"03", d:"dBASE III file"})
def.insert({e:"DB4", s:"04", d:"dBASE IV file"})
def.insert({e:"DBA", s:"00014244", d:"Palm DateBook Archive"})
def.insert({e:"DBB", s:"6C33336C", d:"Skype user data file"})
def.insert({e:"DBF", s:"4F504C4461746162", d:"Psion Series 3 Database"})
def.insert({e:"DBX", s:"CFAD12FE", d:"Outlook Express e-mail folder"})
def.insert({e:"DCI", s:"3C21646F63747970", d:"AOL HTML mail"})
def.insert({e:"DCX", s:"B168DE3A", d:"PCX bitmap"})
def.insert({e:"dex", s:"6465780A30303900", d:"Dalvik (Android) executable file"})
def.insert({e:"DIB", s:"424D", d:"Bitmap image"})
def.insert({e:"DLL", s:"4D5A", d:"Windows|DOS executable file"})
def.insert({e:"DLL", f:"EXE32", d:"PE (Win32) executable file"})
def.insert({e:"DMG", s:"78", d:"MacOS X image file"})
def.insert({e:"DMP", s:"504147454455", d:"Windows memory dump"})
def.insert({e:"DMP", s:"4D444D5093A7", d:"Windows dump file"})
def.insert({e:"DMS", s:"444D5321", d:"Amiga DiskMasher compressed archive"})
def.insert({e:"DOC", s:"0D444F43", d:"DeskMate Document"})
def.insert({e:"DOC", s:"CF11E0A1B11AE100", d:"Perfect Office document"})
def.insert({e:"DOC", s:"ECA5C100", d:"Word document subheader"})
def.insert({e:"DOC", s:"DBA52D00", d:"Word 2.0 file"})
def.insert({e:"DOC", s:"D0CF11E0A1B11AE1", d:"Microsoft Office document"})
def.insert({e:"DOCX", s:"504B0304", d:"MS Office Open XML Format Document"})
def.insert({e:"DOCX", s:"504B030414000600", d:"MS Office 2007 documents"})
def.insert({e:"DOT", s:"D0CF11E0A1B11AE1", d:"Microsoft Office document"})
def.insert({e:"DRV", s:"4D5A", d:"Windows|DOS executable file"})
def.insert({e:"DRV", f:"EXE32", d:"PE (Win32) executable file"})
def.insert({e:"DRW", s:"07", d:"Generic drawing programs"})
def.insert({e:"DRW", s:"01FF02040302", d:"Micrografx vector graphic file"})
def.insert({e:"DS4", s:"52494646", d:"Micrografx Designer graphic"})
def.insert({e:"DSN", s:"4D56", d:"CD Stomper Pro label file"})
def.insert({e:"DSP", s:"23204D6963726F73", d:"MS Developer Studio project file"})
def.insert({e:"DSS", s:"02647373", d:"Digital Speech Standard file"})
def.insert({e:"DSW", s:"64737766696C65", d:"MS Visual Studio workspace file"})
def.insert({e:"DTD", s:"0764743264647464", d:"DesignTools 2D Design file"})
def.insert({e:"DUN", s:"5B50686F6E655D", d:"Dial-up networking file"})
def.insert({e:"DVF", s:"4D535F564F494345", d:"Sony Compressed Voice File"})
def.insert({e:"DVR", s:"445644", d:"DVR-Studio stream file"})
def.insert({e:"DW4", s:"4F7B", d:"Visio|DisplayWrite 4 text file"})
def.insert({e:"DWG", s:"41433130", d:"Generic AutoCAD drawing"})
def.insert({e:"E01", s:"455646090D0AFF00", d:"Expert Witness Compression Format"})
def.insert({e:"E01", s:"4C5646090D0AFF00", d:"Logical File Evidence Format"})
def.insert({e:"ECF", s:"5B47656E6572616C", d:"MS Exchange configuration file"})
def.insert({e:"EFX", s:"DCFE", d:"eFax file"})
def.insert({e:"EML", s:"46726F6D", d:"Generic e-mail_2"})
def.insert({e:"EML", s:"52657475726E2D50", d:"Generic e-mail_1"})
def.insert({e:"EML", s:"582D", d:"Exchange e-mail"})
def.insert({e:"ENL", s:"40404020000040404040", d:"EndNote Library File"})
def.insert({e:"EPS", s:"C5D0D3C6", d:"Adobe encapsulated PostScript"})
def.insert({e:"EPS", s:"252150532D41646F", d:"Encapsulated PostScript file"})
def.insert({e:"ETH", s:"1A350100", d:"WinPharoah capture file"})
def.insert({e:"EVT", s:"300000004C664C65", d:"Windows Event Viewer file"})
def.insert({e:"EVTX", s:"456C6646696C6500", d:"Windows Vista event log"})
def.insert({e:"EXE", s:"4D5A", d:"Windows|DOS executable file"})
def.insert({e:"EXE", f:"EXE32", d:"PE (Win32) executable file"})
def.insert({e:"FDF", s:"25504446", d:"PDF file"})
def.insert({e:"FLAC", s:"664C614300000022", d:"Free Lossless Audio Codec file"})
def.insert({e:"FLI", s:"0011", d:"FLIC animation"})
def.insert({e:"FLT", s:"76323030332E3130", d:"Qimage filter"})
def.insert({e:"FLT", s:"4D5A900003000000", d:"Audition graphic filter"})
def.insert({e:"FLV", s:"464C56", d:"Flash video file"})
def.insert({e:"FM", s:"3C4D616B65724669", d:"Adobe FrameMaker"})
def.insert({e:"FON", s:"4D5A", d:"Font file"})
def.insert({e:"FTR", s:"D20A0000", d:"WinPharoah filter file"})
def.insert({e:"GHO", s:"FEEF", d:"Symantex Ghost image file"})
def.insert({e:"GHS", s:"FEEF", d:"Symantex Ghost image file"})
def.insert({e:"GID", s:"4C4E0200", d:"Windows help file_3"})
def.insert({e:"GID", s:"3F5F0300", d:"Windows Help file_2"})
def.insert({e:"GIF", s:"47494638", d:"GIF file"})
def.insert({e:"GPG", s:"99", d:"GPG public keyring"})
def.insert({e:"GRP", s:"504D4343", d:"Windows Program Manager group file"})
def.insert({e:"GX2", s:"475832", d:"Show Partner graphics file"})
def.insert({e:"GZ", s:"1F8B08", d:"GZIP archive file"})
def.insert({e:"HAP", s:"91334846", d:"Hamarsoft compressed archive"})
def.insert({e:"HDMP", s:"4D444D5093A7", d:"Windows dump file"})
def.insert({e:"HDR", s:"233F52414449414E", d:"Radiance High Dynamic Range image file"})
def.insert({e:"HDR", s:"49536328", d:"Install Shield compressed file"})
def.insert({e:"HLP", s:"4C4E0200", d:"Windows help file_3"})
def.insert({e:"HLP", s:"3F5F0300", d:"Windows Help file_2"})
def.insert({e:"HLP", s:"0000FFFFFFFF", d:"Windows Help file_1"})
def.insert({e:"HQX", s:"2854686973206669", d:"BinHex 4 Compressed Archive"})
def.insert({e:"ICO", s:"00000100", d:"Windows icon|printer spool file"})
def.insert({e:"IDX", s:"414F4C", d:"AOL config files"})
def.insert({e:"IDX", s:"414F4C4442", d:"AOL user configuration"})
def.insert({e:"IDX", s:"5000000020000000", d:"Quicken QuickFinder Information File"})
def.insert({e:"IFO", s:"445644", d:"DVD info file"})
def.insert({e:"IMG", s:"53434D49", d:"Img Software Bitmap"})
def.insert({e:"IMG", s:"504943540008", d:"ChromaGraph Graphics Card Bitmap"})
def.insert({e:"IMG", s:"EB3C902A", d:"GEM Raster file"})
def.insert({e:"IND", s:"414F4C", d:"AOL config files"})
def.insert({e:"IND", s:"414F4C494458", d:"AOL client preferences|settings file"})
def.insert({e:"INFO", s:"E310000100000000", d:"Amiga icon"})
def.insert({e:"INFO", s:"7A626578", d:"ZoomBrowser Image Index"})
def.insert({e:"INFO", s:"5468697320697320", d:"GNU Info Reader file"})
def.insert({e:"ISO", s:"4344303031", d:"ISO-9660 CD Disc Image"})
def.insert({e:"IVR", s:"2E524543", d:"RealPlayer video file (V11+)"})
def.insert({e:"JAR", s:"504B0304", d:"Java archive_1"})
def.insert({e:"JAR", s:"4A4152435300", d:"JARCS compressed archive"})
def.insert({e:"JAR", s:"5F27A889", d:"Jar archive"})
def.insert({e:"JAR", s:"504B030414000800", d:"Java archive_2"})
def.insert({e:"JFIF", s:"FFD8FFE0", d:"JFIF IMAGE FILE - jpeg"})
def.insert({e:"JFIF", s:"FFD8FFE0", d:"JPEG IMAGE"})
def.insert({e:"JG", s:"4A47040E", d:"AOL ART file_2"})
def.insert({e:"JG", s:"4A47030E", d:"AOL ART file_1"})
def.insert({e:"JNT", s:"4E422A00", d:"MS Windows journal"})
def.insert({e:"JP2", s:"0000000C6A502020", d:"JPEG2000 image files"})
def.insert({e:"JPE", s:"FFD8FFE0", d:"JPEG IMAGE"})
def.insert({e:"JPE", s:"FFD8FFE0", d:"JPE IMAGE FILE - jpeg"})
def.insert({e:"JPEG", s:"FFD8FFE0", d:"JPEG IMAGE"})
def.insert({e:"JPEG", s:"FFD8FFE3", d:"SAMSUNG D500 JPEG FILE"})
def.insert({e:"JPEG", s:"FFD8FFE2", d:"CANNON EOS JPEG FILE"})
def.insert({e:"JPG", s:"FFD8FFE8", d:"Still Picture Interchange File Format (SPIFF)"})
def.insert({e:"JPG", s:"FFD8FFE0", d:"JPEG IMAGE"})
def.insert({e:"JPG", s:"FFD8FFE1", d:"Digital camera JPG using Exchangeable Image File Format (EXIF)"})
def.insert({e:"JTP", s:"4E422A00", d:"MS Windows journal"})
def.insert({e:"KGB", s:"4B47425F61726368", d:"KGB archive"})
def.insert({e:"KOZ", s:"49443303000000", d:"Sprint Music Store audio"})
def.insert({e:"KWD", s:"504B0304", d:"KWord document"})
def.insert({e:"LBK", s:"C8007900", d:"Jeppesen FliteLog file"})
def.insert({e:"LGC", s:"7B0D0A6F20", d:"Windows application log"})
def.insert({e:"LGD", s:"7B0D0A6F20", d:"Windows application log"})
def.insert({e:"LHA", s:"2D6C68", d:"Compressed archive"})
def.insert({e:"LIB", s:"213C617263683E0A", d:"Unix archiver (ar)|MS Program Library Common Object File Format (COFF)"})
def.insert({e:"LIT", s:"49544F4C49544C53", d:"MS Reader eBook"})
def.insert({e:"LNK", s:"4C00000001140200", d:"Windows shortcut file"})
def.insert({e:"LOG", s:"2A2A2A2020496E73", d:"Symantec Wise Installer log"})
def.insert({e:"LWP", s:"576F726450726F", d:"Lotus WordPro file"})
def.insert({e:"LZH", s:"2D6C68", d:"Compressed archive"})
def.insert({e:"M4A", s:"00000020667479704D3441", d:"Apple audio and video files"})
def.insert({e:"MANIFEST", s:"3C3F786D6C2076657273696F6E3D", d:"Windows Visual Stylesheet"})
def.insert({e:"MAR", s:"4D41723000", d:"MAr compressed archive"})
def.insert({e:"MAR", s:"4D415243", d:"Microsoft|MSN MARC archive"})
def.insert({e:"MAR", s:"4D41523100", d:"Mozilla archive"})
def.insert({e:"MDB", s:"000100005374616E64617264204A6574204442", d:"Microsoft Access"})
def.insert({e:"MDF", s:"010F0000", d:"SQL Data Base"})
def.insert({e:"MDI", s:"4550", d:"MS Document Imaging file"})
def.insert({e:"MID", s:"4D546864", d:"MIDI sound file"})
def.insert({e:"MIDI", s:"4D546864", d:"MIDI sound file"})
def.insert({e:"MIF", s:"56657273696F6E20", d:"MapInfo Interchange Format file"})
def.insert({e:"MIF", s:"3C4D616B65724669", d:"Adobe FrameMaker"})
def.insert({e:"MKV", s:"1A45DFA393428288", d:"Matroska stream file"})
def.insert({e:"MLS", s:"4D494C4553", d:"Milestones project management file"})
def.insert({e:"MLS", s:"4D563243", d:"Milestones project management file_2"})
def.insert({e:"MLS", s:"4D4C5357", d:"Skype localization data file"})
def.insert({e:"MLS", s:"4D56323134", d:"Milestones project management file_1"})
def.insert({e:"MMF", s:"4D4D4D440000", d:"Yamaha Synthetic music Mobile Application Format"})
def.insert({e:"MNY", s:"000100004D534953414D204461746162617365", d:"Microsoft Money file"})
def.insert({e:"MOF", s:"FFFE23006C006900", d:"MSinfo file"})
def.insert({e:"MOV", s:"736B6970", d:"QuickTime movie_6"})
def.insert({e:"MOV", s:"706E6F74", d:"QuickTime movie_5"})
def.insert({e:"MOV", s:"77696465", d:"QuickTime movie_4"})
def.insert({e:"MOV", s:"6D646174", d:"QuickTime movie_3"})
def.insert({e:"MOV", s:"66726565", d:"QuickTime movie_2"})
def.insert({e:"MOV", s:"6D6F6F76", d:"QuickTime movie_1"})
def.insert({e:"MP", s:"0CED", d:"Monochrome Picture TIFF bitmap"})
def.insert({e:"MP3", s:"494433", d:"MP3 audio file"})
def.insert({e:"MPG", s:"000001B3", d:"MPEG video file"})
def.insert({e:"MPG", s:"000001BA", d:"DVD video file"})
def.insert({e:"MSC", s:"D0CF11E0A1B11AE1", d:"Microsoft Common Console Document"})
def.insert({e:"MSC", s:"3C3F786D6C2076657273696F6E3D22312E30223F3E0D0A3C4D4D435F436F6E736F6C6546696C6520436F6E736F6C65566572", d:"MMC Snap-in Control file"})
def.insert({e:"MSI", s:"D0CF11E0A1B11AE1", d:"Microsoft Installer package"})
def.insert({e:"MSI", s:"2320", d:"Cerius2 file"})
def.insert({e:"MSV", s:"4D535F564F494345", d:"Sony Compressed Voice File"})
def.insert({e:"MTW", s:"D0CF11E0A1B11AE1", d:"Minitab data file"})
def.insert({e:"NRI", s:"0E4E65726F49534F", d:"Nero CD compilation"})
def.insert({e:"NSF", s:"4E45534D1A01", d:"NES Sound file"})
def.insert({e:"NSF", s:"1A0000040000", d:"Lotus Notes database"})
def.insert({e:"NTF", s:"1A0000", d:"Lotus Notes database template"})
def.insert({e:"NTF", s:"30314F52444E414E", d:"National Transfer Format Map"})
def.insert({e:"NTF", s:"4E49544630", d:"National Imagery Transmission Format file"})
def.insert({e:"NVRAM", s:"4D52564E", d:"VMware BIOS state file"})
def.insert({e:"OBJ", s:"80", d:"Relocatable object code"})
def.insert({e:"OBJ", s:"4C01", d:"MS COFF relocatable object code"})
def.insert({e:"OCX", s:"4D5A", d:"ActiveX|OLE Custom Control"})
def.insert({e:"ODP", s:"504B0304", d:"OpenDocument template"})
def.insert({e:"ODT", s:"504B0304", d:"OpenDocument template"})
def.insert({e:"OGA", s:"4F67675300020000", d:"Ogg Vorbis Codec compressed file"})
def.insert({e:"OGG", s:"4F67675300020000", d:"Ogg Vorbis Codec compressed file"})
def.insert({e:"OGV", s:"4F67675300020000", d:"Ogg Vorbis Codec compressed file"})
def.insert({e:"OGX", s:"4F67675300020000", d:"Ogg Vorbis Codec compressed file"})
def.insert({e:"OLB", s:"4D5A", d:"OLE object library"})
def.insert({e:"ONE", s:"E4525C7B8CD8A74D", d:"MS OneNote note"})
def.insert({e:"OPT", s:"FDFFFFFF20", d:"Developer Studio subheader"})
def.insert({e:"OPT", s:"D0CF11E0A1B11AE1", d:"Developer Studio File Options file"})
def.insert({e:"ORG", s:"414F4C564D313030", d:"AOL personal file cabinet"})
def.insert({e:"OTT", s:"504B0304", d:"OpenDocument template"})
def.insert({e:"P10", s:"64000000", d:"Intel PROset|Wireless Profile"})
def.insert({e:"PAK", s:"5041434B", d:"Quake archive file"})
def.insert({e:"PAK", s:"1A0B", d:"PAK Compressed archive file"})
def.insert({e:"PAT", s:"47504154", d:"GIMP pattern file"})
def.insert({e:"PAX", s:"504158", d:"PAX password protected bitmap"})
def.insert({e:"PCH", s:"564350434830", d:"Visual C PreCompiled header"})
def.insert({e:"PCX", s:"0A050101", d:"ZSOFT Paintbrush file_3"})
def.insert({e:"PCX", s:"0A030101", d:"ZSOFT Paintbrush file_2"})
def.insert({e:"PCX", s:"0A020101", d:"ZSOFT Paintbrush file_1"})
def.insert({e:"PDB", s:"4D6963726F736F667420432F432B2B20", d:"MS C++ debugging symbols file"})
def.insert({e:"PDB", s:"4D2D5720506F636B", d:"Merriam-Webster Pocket Dictionary"})
def.insert({e:"PDB", s:"ACED000573720012", d:"BGBlitz position database file"})
def.insert({e:"PDB", s:"737A657A", d:"PowerBASIC Debugger Symbols"})
def.insert({e:"PDB", s:"736D5F", d:"PalmOS SuperMemo"})
def.insert({e:"PDF", s:"25504446", d:"PDF file"})
def.insert({e:"PF", s:"1100000053434341", d:"Windows prefetch file"})
def.insert({e:"PFC", s:"414F4C564D313030", d:"AOL personal file cabinet"})
def.insert({e:"PFC", s:"414F4C", d:"AOL config files"})
def.insert({e:"PGD", s:"504750644D41494E", d:"PGP disk image"})
def.insert({e:"PGM", s:"50350A", d:"Portable Graymap Graphic"})
def.insert({e:"PIF", s:"4D5A", d:"Windows|DOS executable file"})
def.insert({e:"PIF", f:"EXE32", d:"PE (Win32) executable file"})
def.insert({e:"PKR", s:"9901", d:"PGP public keyring"})
def.insert({e:"PNG", s:"89504E470D0A1A0A", d:"PNG image"})
def.insert({e:"PPS", s:"D0CF11E0A1B11AE1", d:"Microsoft Office document"})
def.insert({e:"PPT", s:"FDFFFFFF1C000000", d:"PowerPoint presentation subheader_5"})
def.insert({e:"PPT", s:"D0CF11E0A1B11AE1", d:"Microsoft Office document"})
def.insert({e:"PPT", s:"FDFFFFFF0E000000", d:"PowerPoint presentation subheader_4"})
def.insert({e:"PPT", s:"A0461DF0", d:"PowerPoint presentation subheader_3"})
def.insert({e:"PPT", s:"0F00E803", d:"PowerPoint presentation subheader_2"})
def.insert({e:"PPT", s:"006E1EF0", d:"PowerPoint presentation subheader_1"})
def.insert({e:"PPT", s:"FDFFFFFF43000000", d:"PowerPoint presentation subheader_6"})
def.insert({e:"PPTX", s:"504B0304", d:"MS Office Open XML Format Document"})
def.insert({e:"PPTX", s:"504B030414000600", d:"MS Office 2007 documents"})
def.insert({e:"PPZ", s:"4D534346", d:"Powerpoint Packaged Presentation"})
def.insert({e:"PRC", s:"74424D504B6E5772", d:"PathWay Map file"})
def.insert({e:"PRC", s:"424F4F4B4D4F4249", d:"Palmpilot resource file"})
def.insert({e:"PSD", s:"38425053", d:"Photoshop image"})
def.insert({e:"PSP", s:"7E424B00", d:"Corel Paint Shop Pro image"})
def.insert({e:"PUB", s:"D0CF11E0A1B11AE1", d:"MS Publisher file"})
def.insert({e:"PWI", s:"7B5C707769", d:"MS WinMobile personal note"})
def.insert({e:"PWL", s:"E3828596", d:"Win98 password file"})
def.insert({e:"PWL", s:"B04D4643", d:"Win95 password file"})
def.insert({e:"QBB", s:"458600000600", d:"QuickBooks backup"})
def.insert({e:"QCP", s:"52494646", d:"Resource Interchange File Format"})
def.insert({e:"QDF", s:"AC9EBD8F0000", d:"QDF Quicken data"})
def.insert({e:"QEL", s:"51454C20", d:"QDL Quicken data"})
def.insert({e:"QEMU", s:"514649", d:"Qcow Disk Image"})
def.insert({e:"QPH", s:"03000000", d:"Quicken price history"})
def.insert({e:"QSD", s:"5157205665722E20", d:"ABD | QSD Quicken data file"})
def.insert({e:"QTS", s:"4D5A", d:"Windows|DOS executable file"})
def.insert({e:"QTS", f:"EXE32", d:"PE (Win32) executable file"})
def.insert({e:"QTX", s:"4D5A", d:"Windows|DOS executable file"})
def.insert({e:"QTX", f:"EXE32", d:"PE (Win32) executable file"})
def.insert({e:"QXD", s:"00004D4D585052", d:"Quark Express (Motorola)"})
def.insert({e:"QXD", s:"00004949585052", d:"Quark Express (Intel)"})
def.insert({e:"RA", s:"2E7261FD00", d:"RealAudio streaming media"})
def.insert({e:"RA", s:"2E524D4600000012", d:"RealAudio file"})
def.insert({e:"RAM", s:"727473703A2F2F", d:"RealMedia metafile"})
def.insert({e:"RAR", s:"526172211A0700", d:"WinRAR compressed archive"})
def.insert({e:"REG", s:"FFFE", d:"Windows Registry file"})
def.insert({e:"REG", s:"52454745444954", d:"WinNT Registry|Registry Undo files"})
def.insert({e:"RGB", s:"01DA01010003", d:"Silicon Graphics RGB Bitmap"})
def.insert({e:"RM", s:"2E524D46", d:"RealMedia streaming media"})
def.insert({e:"RMI", s:"52494646", d:"Resource Interchange File Format"})
def.insert({e:"RMVB", s:"2E524D46", d:"RealMedia streaming media"})
def.insert({e:"RPM", s:"EDABEEDB", d:"RedHat Package Manager"})
def.insert({e:"RTD", s:"43232B44A4434DA5", d:"RagTime document"})
def.insert({e:"RTF", s:"7B5C72746631", d:"RTF file"})
def.insert({e:"RVT", s:"D0CF11E0A1B11AE1", d:"Revit Project file"})
def.insert({e:"SAM", s:"5B7665725D", d:"Lotus AMI Pro document_2"})
def.insert({e:"SAM", s:"5B5645525D", d:"Lotus AMI Pro document_1"})
def.insert({e:"SAV", s:"24464C3240282329", d:"SPSS Data file"})
def.insert({e:"SCR", s:"4D5A", d:"Screen saver"})
def.insert({e:"SDR", s:"534D415254445257", d:"SmartDraw Drawing file"})
def.insert({e:"SH3", s:"4848474231", d:"Harvard Graphics presentation file"})
def.insert({e:"SHD", s:"4B490000", d:"Win9x printer spool file"})
def.insert({e:"SHD", s:"66490000", d:"WinNT printer spool file"})
def.insert({e:"SHD", s:"68490000", d:"Win Server 2003 printer spool file"})
def.insert({e:"SHD", s:"67490000", d:"Win2000|XP printer spool file"})
def.insert({e:"SHW", s:"53484F57", d:"Harvard Graphics presentation"})
def.insert({e:"SIT", s:"5374756666497420", d:"StuffIt compressed archive"})
def.insert({e:"SIT", s:"5349542100", d:"StuffIt archive"})
def.insert({e:"SKF", s:"07534B46", d:"SkinCrafter skin"})
def.insert({e:"SKR", s:"9501", d:"PGP secret keyring_2"})
def.insert({e:"SKR", s:"9500", d:"PGP secret keyring_1"})
def.insert({e:"SLE", s:"3A56455253494F4E", d:"Surfplan kite project file"})
def.insert({e:"SLE", s:"414376", d:"Steganos virtual secure drive"})
def.insert({e:"SLN", s:"4D6963726F736F66742056697375616C", d:"Visual Studio .NET file"})
def.insert({e:"SNM", s:"001E849000000000", d:"Netscape Communicator (v4) mail folder"})
def.insert({e:"SNP", s:"4D534346", d:"MS Access Snapshot Viewer file"})
def.insert({e:"SOU", s:"D0CF11E0A1B11AE1", d:"Visual Studio Solution User Options file"})
def.insert({e:"SPL", s:"00000100", d:"Windows icon|printer spool file"})
def.insert({e:"SPO", s:"D0CF11E0A1B11AE1", d:"SPSS output file"})
def.insert({e:"SUD", s:"52454745444954", d:"WinNT Registry|Registry Undo files"})
def.insert({e:"SUO", s:"FDFFFFFF04", d:"Visual Studio Solution subheader"})
def.insert({e:"SWF", s:"465753", d:"Shockwave Flash player"})
def.insert({e:"SWF", s:"435753", d:"Shockwave Flash file"})
def.insert({e:"SXC", s:"504B0304", d:"StarOffice spreadsheet"})
def.insert({e:"SXD", s:"504B0304", d:"OpenOffice documents"})
def.insert({e:"SXI", s:"504B0304", d:"OpenOffice documents"})
def.insert({e:"SXW", s:"504B0304", d:"OpenOffice documents"})
def.insert({e:"SYS", s:"4D5A", d:"Windows|DOS executable file"})
def.insert({e:"SYS", f:"EXE32", d:"PE (Win32) executable file"})
def.insert({e:"SYS", s:"FFFFFFFF", d:"DOS system driver"})
def.insert({e:"SYS", s:"FF", d:"Windows executable"})
def.insert({e:"SYS", s:"EB", d:"Windows executable file_3"})
def.insert({e:"SYS", s:"E9", d:"Windows executable file_2"})
def.insert({e:"SYS", s:"E8", d:"Windows executable file_1"})
def.insert({e:"SYS", s:"FF4B455942202020", d:"Keyboard driver file"})
def.insert({e:"SYW", s:"414D594F", d:"Harvard Graphics symbol graphic"})
def.insert({e:"TAR", s:"7573746172", d:"Tape Archive"})
def.insert({e:"TAR.BZ2", s:"425A68", d:"bzip2 compressed archive"})
def.insert({e:"TAR.Z", s:"1FA0", d:"Compressed tape archive_2"})
def.insert({e:"TAR.Z", s:"1F9D90", d:"Compressed tape archive_1"})
def.insert({e:"TB2", s:"425A68", d:"bzip2 compressed archive"})
def.insert({e:"TBZ2", s:"425A68", d:"bzip2 compressed archive"})
def.insert({e:"TIB", s:"B46E6844", d:"Acronis True Image"})
def.insert({e:"TIF", s:"4D4D002B", d:"TIFF file_4"})
def.insert({e:"TIF", s:"4D4D002A", d:"TIFF file_3"})
def.insert({e:"TIF", s:"49492A00", d:"TIFF file_2"})
def.insert({e:"TIF", s:"492049", d:"TIFF file_1"})
def.insert({e:"TIFF", s:"4D4D002B", d:"TIFF file_4"})
def.insert({e:"TIFF", s:"4D4D002A", d:"TIFF file_3"})
def.insert({e:"TIFF", s:"49492A00", d:"TIFF file_2"})
def.insert({e:"TIFF", s:"492049", d:"TIFF file_1"})
def.insert({e:"TLB", s:"4D53465402000100", d:"OLE|SPSS|Visual C++ library file"})
def.insert({e:"TR1", s:"0110", d:"Novell LANalyzer capture file"})
def.insert({e:"UCE", s:"55434558", d:"Unicode extensions"})
def.insert({e:"UFA", s:"554641C6D2C1", d:"UFA compressed archive"})
def.insert({e:"VBX", s:"4D5A", d:"VisualBASIC application"})
def.insert({e:"VCD", s:"454E545259564344", d:"VideoVCD|VCDImager file"})
def.insert({e:"VCF", s:"424547494E3A5643", d:"vCard"})
def.insert({e:"VCW", s:"5B4D535643", d:"Visual C++ Workbench Info File"})
def.insert({e:"VHD", s:"636F6E6563746978", d:"Virtual PC HD image"})
def.insert({e:"VMDK", s:"4B444D", d:"VMware 4 Virtual Disk"})
def.insert({e:"VMDK", s:"23204469736B2044", d:"VMware 4 Virtual Disk description"})
def.insert({e:"VMDK", s:"434F5744", d:"VMware 3 Virtual Disk"})
def.insert({e:"VOB", s:"000001BA", d:"DVD video file"})
def.insert({e:"VSD", s:"D0CF11E0A1B11AE1", d:"Visio file"})
def.insert({e:"VXD", s:"4D5A", d:"Windows virtual device drivers"})
def.insert({e:"WAB", s:"813284C18505D011", d:"Outlook Express address book (Win95)"})
def.insert({e:"WAB", s:"9CCBCB8D1375D211", d:"Outlook address file"})
def.insert({e:"WAV", s:"52494646", d:"Resource Interchange File Format"})
def.insert({e:"WB2", s:"00000200", d:"QuattroPro spreadsheet"})
def.insert({e:"WB3", s:"3E000300FEFF090006", d:"Quatro Pro for Windows 7.0"})
def.insert({e:"WIZ", s:"D0CF11E0A1B11AE1", d:"Microsoft Office document"})
def.insert({e:"WK1", s:"0000020006040600", d:"Lotus 1-2-3 (v1)"})
def.insert({e:"WK3", s:"00001A0000100400", d:"Lotus 1-2-3 (v3)"})
def.insert({e:"WK4", s:"00001A0002100400", d:"Lotus 1-2-3 (v4|v5)"})
def.insert({e:"WK5", s:"00001A0002100400", d:"Lotus 1-2-3 (v4|v5)"})
def.insert({e:"WKS", s:"FF00020004040554", d:"Works for Windows spreadsheet"})
def.insert({e:"WKS", s:"0E574B53", d:"DeskMate Worksheet"})
def.insert({e:"WMA", s:"3026B2758E66CF11", d:"Windows Media Audio|Video File"})
def.insert({e:"WMF", s:"D7CDC69A", d:"Windows graphics metafile"})
def.insert({e:"WMV", s:"3026B2758E66CF11", d:"Windows Media Audio|Video File"})
def.insert({e:"WMZ", s:"504B0304", d:"Windows Media compressed skin file"})
def.insert({e:"WP", s:"FF575043", d:"WordPerfect text and graphics"})
def.insert({e:"WP5", s:"FF575043", d:"WordPerfect text and graphics"})
def.insert({e:"WP6", s:"FF575043", d:"WordPerfect text and graphics"})
def.insert({e:"WPD", s:"FF575043", d:"WordPerfect text and graphics"})
def.insert({e:"WPF", s:"81CDAB", d:"WordPerfect text"})
def.insert({e:"WPG", s:"FF575043", d:"WordPerfect text and graphics"})
def.insert({e:"WPL", s:"4D6963726F736F66742057696E646F7773204D6564696120506C61796572202D2D20", d:"Windows Media Player playlist"})
def.insert({e:"WPP", s:"FF575043", d:"WordPerfect text and graphics"})
def.insert({e:"WPS", s:"D0CF11E0A1B11AE1", d:"MSWorks text document"})
def.insert({e:"WRI", s:"BE000000AB", d:"MS Write file_3"})
def.insert({e:"WRI", s:"32BE", d:"MS Write file_2"})
def.insert({e:"WRI", s:"31BE", d:"MS Write file_1"})
def.insert({e:"WS", s:"1D7D", d:"WordStar Version 5.0|6.0 document"})
def.insert({e:"WS2", s:"575332303030", d:"WordStar for Windows file"})
def.insert({e:"XDR", s:"3C", d:"BizTalk XML-Data Reduced Schema"})
def.insert({e:"XLA", s:"D0CF11E0A1B11AE1", d:"Microsoft Office document"})
def.insert({e:"XLS", s:"FDFFFFFF29", d:"Excel spreadsheet subheader_7"})
def.insert({e:"XLS", s:"FDFFFFFF28", d:"Excel spreadsheet subheader_6"})
def.insert({e:"XLS", s:"FDFFFFFF23", d:"Excel spreadsheet subheader_5"})
def.insert({e:"XLS", s:"D0CF11E0A1B11AE1", d:"Microsoft Office document"})
def.insert({e:"XLS", s:"FDFFFFFF22", d:"Excel spreadsheet subheader_4"})
def.insert({e:"XLS", s:"FDFFFFFF1F", d:"Excel spreadsheet subheader_3"})
def.insert({e:"XLS", s:"FDFFFFFF10", d:"Excel spreadsheet subheader_2"})
def.insert({e:"XLS", s:"0908100000060500", d:"Excel spreadsheet subheader_1"})
def.insert({e:"XLSX", s:"504B030414000600", d:"MS Office 2007 documents"})
def.insert({e:"XLSX", s:"504B0304", d:"MS Office Open XML Format Document"})
def.insert({e:"XML", s:"3C3F786D6C2076657273696F6E3D22312E30223F3E", d:"User Interface Language"})
def.insert({e:"XPI", s:"504B0304", d:"Mozilla Browser Archive"})
def.insert({e:"XPS", s:"504B0304", d:"XML paper specification file"})
def.insert({e:"XPT", s:"5850434F4D0A5479", d:"XPCOM libraries"})
def.insert({e:"XPT", s:"504B0304", d:"eXact Packager Models"})
def.insert({e:"ZAP", s:"4D5A90000300000004000000FFFF", d:"ZoneAlam data file"})
def.insert({e:"ZIP", s:"504B0506", d:"PKZIP archive_2"})
def.insert({e:"ZIP", s:"504B0304", d:"PKZIP archive_1"})
def.insert({e:"ZIP", s:"504B537058", d:"PKSFX self-extracting archive"})
def.insert({e:"ZIP", s:"504B4C495445", d:"PKLITE archive"})
def.insert({e:"ZIP", s:"57696E5A6970", d:"WinZip compressed archive"})
def.insert({e:"ZIP", s:"504B030414000100", d:"ZLock Pro encrypted ZIP"})
def.insert({e:"ZIP", s:"504B0708", d:"PKZIP archive_3"})
def.insert({e:"ZOO", s:"5A4F4F20", d:"ZOO compressed archive"})

RegRead, TestReg, HKCR, *\shell\ahkmagic\command
RegChecked := (errorlevel) ? "" : "checked"
Gui, add, listview, x0 y0 vListview, Possible Extension|Description
Gui, add, checkbox, x10 vAddContextmenu gAddContextmenu %RegChecked%, Add AHK-Magic to file context menu
Gui, add, link, x10 r2 vLink, Written 2012 by Bentschi`nSignature-List used from <a href="http://www.filesignatures.net">filesignatures.net</a>
Gui, +Resize +E0x10
Gui, show, hide w400 h400
if (fileexist(file))
  Goto, AnalizeFile
Gui, show,, % "AHK-Magic [Drop a file!]"
return

;Thanks nnnik
GuiDropFiles:
Loop, parse, A_GuiEvent, `n
{
    file := A_LoopField
    Break
}
AnalizeFile:
LV_Delete()
if (!(f := FileOpen(file, "r", "utf-8-raw")))
{
  Gui, show,, % "AHK-Magic [Drop a file!]"
  return
}
o := {f:f}
hex := {0:0, 1:1, 2:2, 3:3, 4:4, 5:5, 6:6, 7:7, 8:8, 9:9, 10:"A", 11:"B", 12:"C", 13:"D", 14:"E", 15:"F"}
hstr := ""
Loop, % 50
{
  c := f.readUChar()
  hstr .= hex[c>>4]
  hstr .= hex[c&0xf]
  o[A_Index*2] := hstr
}
for k,v in def
{
  if (v.hasKey("s") && (o[strlen(v.s)]!=v.s))
    continue
  if (v.hasKey("f") && !func(v.f).(o))
    continue
  LV_Add("", v.e, v.d)
}
Gui, show,, % "AHK-Magic - Results for: " substr(file, instr(file, "\", 0, 0)+1)
return

;Thanks Johnny R.
AddContextmenu:
GuiControlGet, AddContextmenu
if (AddContextmenu)
{
  RegWrite, REG_SZ, HKCR, *\shell\ahkmagic,, Analyze file with AHK-Magic
  if (A_IsCompiled)
    RegWrite, REG_SZ, HKCR, *\shell\ahkmagic\command,, "%A_ScriptFullPath%" "`%1"
  else
    RegWrite, REG_SZ, HKCR, *\shell\ahkmagic\command,, "%A_AhkPath%" "%A_ScriptFullPath%" "`%1"
}
else
  RegDelete, HKCR, *\shell\ahkmagic
return

GuiSize:
GuiControl, movedraw, Listview, % "w" A_GuiWidth " h" A_GuiHeight-80
GuiControl, movedraw, AddContextmenu, % "y" A_GuiHeight-65
GuiControl, movedraw, Link, % "y" A_GuiHeight-45
return

GuiClose:
ExitApp

EXE32(o)
{
  o.f.pos := 0x3c
  o.f.pos := o.f.readUInt()
  return (o.f.readUInt()=0x4550)?1:0
}