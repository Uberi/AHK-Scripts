;AHK v1
#NoEnv

;MsgBox % ChooseColor()

ChooseColor(InitialColor = 0x000000,hWindow = 0)
{
 static Dialog
 If !VarSetCapacity(Dialog)
 {
  Data := "24000000000000000000000000000000000000004700000000000000000000000000000000000000800000000080000080800000000080008000800000808000C0C0C00080808000FF00000000FF0000FFFF00000000FF00FF00FF0000FFFF00FFFFFF00C020C88008000000100000000000900090000000000043006F006C006F00720020002000200020002000200020002000200020002000200020002000200020002000000008004D00530020005300680065006C006C00200044006C00670000000B000350000000006AFF0F008C005600D002FFFF82000000000000000B00035000000000050003008C001C00D102FFFF82000000000000000B10005000000000070021006A003600C602FFFF82000000000000000B100050000000007600210013003600BE02FFFF82000000000000000B1000500000000060005B002A001B00C502FFFF8200000000000000000202500000000007005B0014000C00D602FFFF82005200470042003A0000000000000002008350000000001B005B0014000C00C202FFFF8100000000000000020083500000000031005B0014000C00C302FFFF8100000000000000020083500000000047005B0014000C00C402FFFF810000000000000000020250000000000700690014000C00D302FFFF820048004C0053003A0000000000000002008350000000001B00690014000C00BF02FFFF810000000000000002008350000000004700690014000C00C002FFFF810000000000000002008350000000003100690014000C00C102FFFF8100000000000000100000500000000005007A0087000100E603FFFF820000000000000001000350000000005F007F0028000E000100FFFF80004F004B0000000000000000000350000000002F007F002C000E000200FFFF8000430061006E00630065006C00000000000000"
  Temp1 := StrLen(Data) >> 1, VarSetCapacity(Dialog,Temp1,0)
  Loop, %Temp1%
   NumPut("0x" . SubStr(Data,(A_Index << 1) - 1,2),Dialog,A_Index - 1,"Char")
 }
 UPtr := A_PtrSize ? "UPtr" : "UInt"
 NumPut(&Dialog + 100,Dialog,8), NumPut(&Dialog + 36,Dialog,16), NumPut(hWindow,Dialog,4), NumPut(((InitialColor & 0xFF) << 16) | (InitialColor & 0xFF00) | ((InitialColor & 0xFF0000) >> 16),Dialog,12)
 If !DllCall("comdlg32\ChooseColorW",UPtr,&Dialog)
  Return
 FormatInteger := A_FormatInteger
 SetFormat, IntegerFast, Hex
 ChosenColor := NumGet(Dialog,12), ChosenColor := SubStr("00000" . SubStr(((ChosenColor & 0xFF) << 16) | (ChosenColor & 0xFF00) | ((ChosenColor & 0xFF0000) >> 16),3),-5)
 StringUpper, ChosenColor, ChosenColor
 SetFormat, IntegerFast, %FormatInteger%
 Return, ChosenColor
}